$(function(){var active_coupons="SUMMER25";var active_discount=.25;var play_mp4=false;var testvideo=document.createElement("video");play_mp4=testvideo.canPlayType&&testvideo.canPlayType("video/mp4")!="";play_mp4=testvideo.canPlayType&&testvideo.canPlayType("video/webm")=="";var pixel_d=window.devicePixelRatio||1;var gasend=function(a,b,c,d,e,f){if(typeof ga!="undefined")ga(a,b,c,d,e,f);if(typeof gtag!="undefined"){if(b=="event"){gtag("event",c,{event_category:d,event_label:e,value:f})}}};var $videos=$("video.gif");var isOnScreen=function($el){var win=$(window);var viewport={top:win.scrollTop(),left:win.scrollLeft()};viewport.right=viewport.left+win.width();viewport.bottom=viewport.top+win.height();var bounds=$el.offset();var h=$el.outerHeight();bounds.right=bounds.left+$el.outerWidth();bounds.bottom=bounds.top+h;if(viewport.bottom>=bounds.top&&viewport.top<=bounds.bottom){var hoffs=viewport.top-bounds.top;if(hoffs<0)hoffs=0;if(viewport.bottom<bounds.bottom){hoffs+=bounds.bottom-viewport.bottom}return(h-hoffs)/h}return 0;return!(viewport.right<bounds.left||viewport.left>bounds.right||viewport.bottom<bounds.top||viewport.top>bounds.bottom)};var removePlayProgress=function(){$(".play-progress").remove()};var showPlayProgress=function($a,$player){var $ca=$a.clone();$ca.addClass("play-progress");$ca.appendTo($a);$ca.css("width",0);var player=$player.get(0);$player.on("timeupdate",function(){var pos=player.currentTime;var dur=player.duration;var percent=Math.round(100*pos/dur);$ca.css("width",percent+"%")});$player.on("ended",function(){setTimeout(function(){$ca.addClass("ended");if(!more_videos_clicked){showPlayMoreTooltip($a)}},1e3)})};var showGifTimer=null;var showGifWhenScrolledIntoView=function(){showGifTimer=null;var max_vis_gif=null;var max_vis_p=0;var full=[];var hidden=[];$videos.each(function(i,c){var $gif=$(c);var pos=isOnScreen($gif);if(pos>.25){full.push(c);max_vis_gif=c;max_vis_p=pos}else if(pos>max_vis_p){if(max_vis_gif){}max_vis_gif=c;max_vis_p=pos}else if(pos==0){hidden.push(c)}});if(max_vis_gif)full.push(max_vis_gif);$.each(full,function(i,gif){var $gif=$(gif);var $wrap=$gif.parent();var $over=$wrap.find(".gif-overlay");var pic=$gif.attr("data-src");if(pic!=$gif.attr("src")){if(!$gif.data("image-loader")){if(!$gif.data("auto-played")){$gif.get(0).play();$gif.data("auto-played",true);var $a=$gif.closest(".feature-content").find('a[href="'+$gif.attr("src")+'"]');showPlayProgress($a,$gif)}}}});$.each(hidden,function(i,gif){var $gif=$(gif);var is_gif=$gif.is("img");var pic=$gif.attr("src");if(!is_gif||pic!=gifph){$gif.data("restart-on-show",true)}})};var playVideoForLink=function($a){var url=$a.attr("href");var poster_url="pg4assets/movies/movie.loading.jpg";var base_url=url.replace("_1920.mp4","").replace("_1920.webm","");var video_size=$("body").width()/2*pixel_d>1400?"1920":"1280";url=base_url+"_"+video_size+"."+(play_mp4?"mp4":"webm");console.log("playing "+url);$("ul.topics").tooltip("hide");var $fc=$a.closest(".feature-container");var $wrap=$fc.find(".gif-wrap");var delay=1e3;var title_delay=5e3;$wrap.find(".play-button").addClass("clicked");var $player_old=$wrap.find("video");$wrap.find(".video-title").remove();var desc=$a.attr("data-desc")||"Intro text missing!";if(desc){$('<div class="video-title"><p>See Pinegrow in action</p><h3>'+desc+'</h3><div class="title-progress"><div class="line"></div></div></div>').appendTo($wrap)}$wrap.find(".feature-poster").addClass("fadeOut");removePlayProgress();$player_old.each(function(i,p){p.pause()}).addClass("play-video-old");var $player=$('<video control="false" src="'+url+'" class="gif play-video-new" src="" poster="'+poster_url+'"></video>');$player.appendTo($wrap);setTimeout(function(){$player.removeClass("play-video-new");var player=$player.get(0);player.play();showPlayProgress($a,$player)},title_delay);setTimeout(function(){$wrap.find(".play-video-old").remove()},delay*2)};var showPlayMoreTooltip=function($a){return;var $ul=$a.closest("ul");$ul.tooltip({placement:$("body").width()<1e3?"bottom":"right",container:"body",html:true,title:"Watch more short video clips.",trigger:"manual"});$ul.tooltip("show")};var $ul=$("ul.topics").first();$ul.tooltip({placement:"bottom",html:true,title:"See Pinegrow in action. Watch short video clips.",trigger:"manual"});$ul.tooltip("show");var more_videos_clicked=false;var $play_videos=$(".play-video");$play_videos.on("click",function(e){e.preventDefault();var $a=$(this);playVideoForLink($a);more_videos_clicked=true});$(".gif-wrap").each(function(i,p){var $p=$(p);$p.append('<div class="play-button"><i class="icon icon-video"></i></div>')});$(".feature-poster,.gif-wrap .play-button").on("click",function(e){e.preventDefault();var $f=$(this).closest(".feature-content");playVideoForLink($f.find("a.play-video").first())});$(window).on("resize",function(){});$(".buy-compare-button").on("click",function(e){e.preventDefault();var $b=$(".buy-compare-boxes-row");if($b.hasClass("hide")){$b.removeClass("hide");$(this).removeClass("buy-compare-button-hidden");$("#buy").addClass("compare-shown")}else{$b.addClass("hide");$(this).addClass("buy-compare-button-hidden");$("#buy").removeClass("compare-shown")}});$("[data-slider]").each(function(i,e){var $controler=$(e);var $s=$($controler.attr("data-slider"));var $slides=$s.find(".boxes-slider-slide");var $c=$s.find(".boxes-slider-container");$c.css("width",$slides.length*100+"%");var slide_size=100/$slides.length;$slides.css("width",slide_size+"%");$controler.on("click","a",function(e){e.preventDefault();var $a=$(this);var idx=$a.index();$c.css("transform","translateX("+-slide_size*idx+"%)");$controler.find(".active").removeClass("active");$a.addClass("active");$s=$($slides.get(idx));var name=$s.attr("data-active-slide")||"default";$c.closest(".buy-content").attr("data-active-slide",name);$s.attr("data-active-slide",name)})});$("#buy-tabs a").click(function(e){e.preventDefault();$(this).tab("show");var $tab=$($(this).attr("href"));var name=$tab.find("[data-active-slide]").attr("data-active-slide")||"default";$(".buy-content").attr("data-active-slide",name)});$('a[href="#company-licenses-show"]').on("click",function(e){e.preventDefault();$('a[href="#company-licenses"]').trigger("click")});$('a[href="#personal-licenses-show"]').on("click",function(e){e.preventDefault();$('a[href="#personal-licenses"]').trigger("click")});var $body=$("body");var pgCreateVideoModals=function(videos){$.each(videos,function(i,v){$body.append('<div class="modal fade videoModal" id="'+v.id+'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;" data-src="'+v.src+'">                            <div class="modal-dialog modal-lg">                            <div class="modal-content">                            <div class="modal-body"><div class="video-container"></div>                    </div>                    <div class="modal-footer">                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>                    </div>                    </div>                    </div>                    </div>')})};$(".hero-play-button").on("click",function(e){e.preventDefault();var $v=$('<iframe width="560" height="315" src="https://www.youtube.com/embed/ITSMOYJ6usA?autoplay=1" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe><button class="close-video">Close video</button>');console.log($(".intro-video"));$(this).closest(".intro-video").append($v);$(".close-video").on("click",function(e){e.preventDefault();$v.remove()})});$(".videoModal").on("show.bs.modal",function(event){var $m=$(event.delegateTarget);var src=$m.attr("data-src");var $v=$('<iframe width="560" height="315" src="'+src+'" frameborder="0" allowfullscreen=""></iframe>');$m.find(".video-container").html("").append($v)});$(".videoModal").on("hide.bs.modal",function(e){var $if=$(e.delegateTarget).closest(".videoModal").find("iframe");var src=$if.attr("src");$if.attr("src","/empty.html")});var tz=(new Date).getTimezoneOffset();if(console&&console.log)console.log(tz);if(tz>=5*50&&tz<=8*60){jQuery(".us-only").removeClass("hide")}if(tz<=2*60&&tz>=-3*60){jQuery(".eu-only").removeClass("hide")}jQuery("form").on("submit",function(e){});jQuery("a.download").on("click",function(e){gasend("send","pageview","/index.html/download")});setTimeout(function(){jQuery("a.paddle, button.paddle_button").on("click",function(e){gasend("send","pageview","/index.html/paddle")});if(location.search&&location.search.indexOf("done")>=0){var value=location.search.indexOf("donecomp")>=0?74:45}},2e3);jQuery('[data-toggle="tooltip"]').tooltip();$(function(){setTimeout(function(){$(".notebar").animate({"margin-top":0},1e3)},3e3);if((window.location+"").indexOf("subscribe")>=0){jQuery(".pricing-subs").removeClass("hide")}var add_discount=0;var $form=$(".order-form");var $form_total=$form.find(".order-form-total-price");var $form_button=$form.find("a.order-button");if((window.location+"").indexOf("cms")>=0){$form.find('[value="PGPRO_CMSUSER"]').prop("checked",true)}var getDiscount=function(num){var d=0;if(num<5){d=0}else if(num<10){d=.2}else if(num<25){d=.3}else if(num<50){d=.4}else{d=.5}return d>0?d+add_discount:d};var getPrice=function(product,sub){var p={PGPRO_COMPANY:179,PGWPPRO_COMPANY:259,PGPRO_CMSUSER:20};var psub={PGPRO_COMPANY:15,PGWPPRO_COMPANY:20,PGPRO_CMSUSER:20};return sub?psub[product]:p[product]};var getCheckoutLink=function(product,num,sub){if(num<1)return"#";var pid=sub?"505048":"505045";var ak=sub?"55mk4":"z0ns95";var price=(num*getDiscountedPrice(getPrice(product,sub),num)).toFixed(2).replace(",",".");var a=md5(price.toString()+ak);var pass="q:"+num+"|sub:"+(sub?"1":"0")+"|p:"+product+"|price:"+price;var link="https://pay.paddle.com/checkout/"+pid+"?passthrough="+pass+"&quantity_variable=0&price="+price+"&auth="+a;return link};var getDiscountedPrice=function(price,num){return price*(1-getDiscount(num))};var formatPrice=function(price,sub){return"$"+price.toFixed(2)+(sub?" / mo":"")};var order_price=0;var update=function(){var product="PGPRO_COMPANY";if($form.find('[value="PGWPPRO_COMPANY"]').is(":checked"))product="PGWPPRO_COMPANY";if($form.find('[value="PGPRO_CMSUSER"]').is(":checked"))product="PGPRO_CMSUSER";var num=parseFloat($form.find(".license-num").val()||"0");if(product=="PGPRO_CMSUSER"){$form.find('.plan[value="pay"]').prop("checked",true);$form.find('.plan[value="sub"]').prop("checked",false).parent().hide()}else{$form.find('.plan[value="sub"]').parent().show()}var sub=false;if($form.find('.plan[value="sub"]').is(":checked"))sub=true;var price=getDiscountedPrice(getPrice(product,sub),num);var total=price*num;$form_total.html("<span>Total price</span>"+formatPrice(total,sub)+' <calc style="font-weight:normal;">('+num+" x "+formatPrice(price)+") + VAT*</calc>");order_price=formatPrice(total,sub);var discount=getDiscount(num);var full_price=getPrice(product,sub);$form.find("table.order-form-prices > tbody > tr").each(function(i,tr){var $tr=$(tr);var $tds=$tr.find(">td");var rowdiscount=parseFloat($tr.attr("data-discount"));if(discount==rowdiscount+add_discount&&num>0){$tr.addClass("order-form-active-price")}else{$tr.removeClass("order-form-active-price")}$($tds.get(2)).html(formatPrice(full_price*(1-rowdiscount-(rowdiscount>0?add_discount:0)),sub));var desc_discount="";if(rowdiscount>0){desc_discount=(rowdiscount*100).toFixed(0)+"%";if(add_discount>0){desc_discount='<span class="order-form-regular-price">'+desc_discount+'</span> <span class="order-form-special-price">'+((rowdiscount+add_discount)*100).toFixed(0)+"%</span>"}}$($tds.get(1)).html(desc_discount)});var link=getCheckoutLink(product,num,sub);$form_button.attr("href",link);$form.attr("action",link)};$form.find("input").on("input change",function(e){update()});var validate=function(e){var num=parseInt($form.find(".license-num").val()||"0");if(!num){alert("Please fill in the number of licenses.");e.preventDefault()}else{if($form.find('.plan[value="sub"]').is(":checked")){alert("NOTE: During the checkout process the monthly fee will be shown as $20 + VAT. Please disregard that information, the correct volume license price of "+order_price+" will be used for the initial charge and for monthly payments. Press OK to continue to checkout.")}}};$form.on("submit",function(e){validate(e)});$form_button.on("click",function(e){validate(e)});if($form.length){update()}});var getPgTransId=function(){return"PG"+(new Date).getTime()+"T"+Math.ceil(Math.random()*1e4)};var getSuccessUrl=function(tid){return"http://pinegrow.com/done.html?transid="+tid};var getCheckoutLink=function(productid,pgtransid){var i={491037:"15pluox"};var link="http://pay.paddle.com/checkout/"+productid;var return_url=getSuccessUrl(pgtransid);var url_coded=Base64.encode(return_url).replace(/\+/g,"/").replace(/\-/g,"_");var auth=md5(url_coded+i[productid]);return link+"?return_url="+url_coded+"&return_url_auth="+auth};var decorateCheckoutLink=function($link,tid){var url=$link.attr("href")+"?passthrough="+tid;$link.attr("href",url)};$(function(){$(".share-popover-link").popover({html:true,placement:"top",content:'<div class="share-popover">'+$(".social-links-container").html()+"</div>",container:"body"})});jQuery('[data-toggle="popover"]').not(".share-popover-link").popover();$(function(){var onGotCountry=function(country){};$(".price-net").each(function(i,e){var $e=$(e);var pid=$e.attr("data-product");if(pid){Paddle.Product.Prices(pid,function(prices){var price=prices.price.net;price=price.replace("US$","$").replace(".00","");$e.html(price);if(onGotCountry){onGotCountry(prices.country);onGotCountry=null}})}});$(".strike-price-net").each(function(i,e){var $e=$(e);var pid=$e.attr("data-product");if(pid){Paddle.Product.Prices(pid,function(prices){var price=prices.price.net;var usd=price.startsWith("US$");price=price.replace("US$","$").replace(".00","");var sp=$.trim($e.text());if(price==sp){$e.remove()}else{if(!usd&&sp.startsWith("$"))$e.html("US"+sp)}})}});var pids=[];$(".buy-box").each(function(i,e){var $box=$(e);var $button=$box.find(".btn");var pid=$button.attr("data-product");if(active_coupons)$button.attr("data-coupon",active_coupons);if(pid&&pid!="none"){pids.push(pid)}});var formatPrice=function(price,currency){price=price.toString().replace(".00","");var cmap={USD:"$",EUR:"€",GBP:"£"};if(cmap[currency]){return'<span class="currency symbol">'+cmap[currency]+"</span>"+price}else{return'<span class="currency">'+currency+"</span>"+price}};Paddle.Setup({vendor:437,eventCallback:function(e){try{if(e.event=="Checkout.PaymentComplete"){var d=e.eventData;var v=parseInt(d.checkout.prices.vendor.total);var p=d.product.name;gasend("send","event","Order","Completed",p,v);if(typeof fbq!="undefined"){fbq("track","Purchase",{value:v,currency:"USD",content_ids:p})}}}catch(err){}}});if(pids.length){Paddle.Product.Prices(pids[0],function(prices){$.ajax({url:"https://checkout.paddle.com/api/2.0/prices?product_ids="+pids.join(",")+"&customer_country="+prices.country+"&coupons="+active_coupons,jsonp:"callback",dataType:"jsonp",success:function(data){if(data&&data.success&&data.response){data.response.products.forEach(function(pinfo){var pid=pinfo.product_id;if(active_discount>0&&pinfo.list_price.net==pinfo.price.net){pinfo.price.net=pinfo.price.net*(1-active_discount)}var $box=$(".buy-box").find('.btn[data-product="'+pid+'"]').closest(".buy-box");var $listp=$box.find(".price-full");$listp.html(formatPrice(pinfo.list_price.net,pinfo.currency));var $price=$box.find(".price");$price.html(formatPrice(pinfo.price.net,pinfo.currency));if(pinfo.list_price.net!=pinfo.price.net)$listp.removeClass("hide");var $button=$box.find(".btn");if($box.hasClass("no-order")){$button.removeAttr("data-product")}})}}})})}})});var loadDeferredStyles=function(){var addStylesNode=document.getElementById("deferred-styles");var replacement=document.createElement("div");replacement.innerHTML=addStylesNode.textContent;document.body.appendChild(replacement);addStylesNode.parentElement.removeChild(addStylesNode)};var raf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(raf)raf(function(){window.setTimeout(loadDeferredStyles,0)});else window.addEventListener("load",loadDeferredStyles);
